{"ast":null,"code":"var _s = $RefreshSig$();\n\nimport React, { useCallback, useContext, useState } from 'react';\nimport Context from \"../Context/UserContextProvider\";\nexport default function useUser() {\n  _s();\n\n  const {\n    jwt,\n    setJWT,\n    user,\n    setUser,\n    rol,\n    setRol\n  } = useContext(Context);\n  const [invalid, setInvalid] = useState(false);\n  const [isLoading, setIsLoading] = useState(false);\n  const login = useCallback(item => {\n    const cargoUtil = JSON.stringify(item);\n    setIsLoading(true);\n    fetch(\"http://localhost/IniciaSessio.php\", {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": 'application/json'\n      },\n      body: cargoUtil\n    }).then(res => {\n      return res.json();\n    }).then(res => {\n      if (!res) return setInvalid(true);\n      console.log(res['rol']);\n      window.sessionStorage.setItem('jwt', res['jwt']);\n      window.sessionStorage.setItem('user', item['usuari']);\n      window.sessionStorage.setItem('rol', res['rol']);\n      setIsLoading(false);\n      setRol(res['rol']);\n      setUser(item['usuari']);\n      setJWT(res['jwt']);\n    }).catch(err => {\n      setIsLoading(false);\n      window.sessionStorage.removeItem('jwt');\n    });\n  }, [setJWT]);\n  const logout = useCallback(() => {\n    window.sessionStorage.removeItem('jwt');\n    window.sessionStorage.removeItem('user');\n    window.sessionStorage.removeItem('rol');\n    setJWT(null);\n    setUser(null);\n  }, [setJWT, setUser]);\n  return {\n    isLogged: Boolean(jwt),\n    isLoading,\n    login,\n    logout,\n    invalid,\n    user,\n    rol\n  };\n}\n\n_s(useUser, \"6704t5C9sP1Eo1SlambrTr+Nrj0=\");\n\n;","map":{"version":3,"sources":["C:/Users/Lucas/OneDrive/Escritorio/TFG/Projecte/aplicacion/src/Servicio/autenticationservice.js"],"names":["React","useCallback","useContext","useState","Context","useUser","jwt","setJWT","user","setUser","rol","setRol","invalid","setInvalid","isLoading","setIsLoading","login","item","cargoUtil","JSON","stringify","fetch","method","headers","body","then","res","json","console","log","window","sessionStorage","setItem","catch","err","removeItem","logout","isLogged","Boolean"],"mappings":";;AAAA,OAAOA,KAAP,IAAeC,WAAf,EAA4BC,UAA5B,EAAwCC,QAAxC,QAAuD,OAAvD;AACA,OAAOC,OAAP,MAAoB,gCAApB;AAEC,eAAe,SAASC,OAAT,GAAoB;AAAA;;AAChC,QAAM;AAACC,IAAAA,GAAD;AAAMC,IAAAA,MAAN;AAAcC,IAAAA,IAAd;AAAoBC,IAAAA,OAApB;AAA6BC,IAAAA,GAA7B;AAAkCC,IAAAA;AAAlC,MAA4CT,UAAU,CAACE,OAAD,CAA5D;AACA,QAAM,CAACQ,OAAD,EAAUC,UAAV,IAAwBV,QAAQ,CAAC,KAAD,CAAtC;AACA,QAAM,CAACW,SAAD,EAAYC,YAAZ,IAA4BZ,QAAQ,CAAC,KAAD,CAA1C;AAEC,QAAMa,KAAK,GAAGf,WAAW,CAAEgB,IAAD,IAAU;AAChC,UAAMC,SAAS,GAAGC,IAAI,CAACC,SAAL,CAAeH,IAAf,CAAlB;AACAF,IAAAA,YAAY,CAAC,IAAD,CAAZ;AACAM,IAAAA,KAAK,CAAC,mCAAD,EAAqC;AACtCC,MAAAA,MAAM,EAAC,MAD+B;AAEtCC,MAAAA,OAAO,EAAE;AACL,wBAAgB;AADX,OAF6B;AAKtCC,MAAAA,IAAI,EAAEN;AALgC,KAArC,CAAL,CAMGO,IANH,CAMQC,GAAG,IAAE;AACT,aAAOA,GAAG,CAACC,IAAJ,EAAP;AACH,KARD,EAQGF,IARH,CAQSC,GAAD,IAAO;AACX,UAAG,CAACA,GAAJ,EAAS,OAAOb,UAAU,CAAC,IAAD,CAAjB;AACTe,MAAAA,OAAO,CAACC,GAAR,CAAYH,GAAG,CAAC,KAAD,CAAf;AACAI,MAAAA,MAAM,CAACC,cAAP,CAAsBC,OAAtB,CAA8B,KAA9B,EAAoCN,GAAG,CAAC,KAAD,CAAvC;AACAI,MAAAA,MAAM,CAACC,cAAP,CAAsBC,OAAtB,CAA8B,MAA9B,EAAqCf,IAAI,CAAC,QAAD,CAAzC;AACAa,MAAAA,MAAM,CAACC,cAAP,CAAsBC,OAAtB,CAA8B,KAA9B,EAAoCN,GAAG,CAAC,KAAD,CAAvC;AACAX,MAAAA,YAAY,CAAC,KAAD,CAAZ;AACAJ,MAAAA,MAAM,CAACe,GAAG,CAAC,KAAD,CAAJ,CAAN;AACAjB,MAAAA,OAAO,CAACQ,IAAI,CAAC,QAAD,CAAL,CAAP;AACAV,MAAAA,MAAM,CAACmB,GAAG,CAAC,KAAD,CAAJ,CAAN;AACH,KAlBD,EAkBGO,KAlBH,CAkBSC,GAAG,IAAI;AACZnB,MAAAA,YAAY,CAAC,KAAD,CAAZ;AACAe,MAAAA,MAAM,CAACC,cAAP,CAAsBI,UAAtB,CAAiC,KAAjC;AACC,KArBL;AAsBH,GAzBwB,EAyBtB,CAAC5B,MAAD,CAzBsB,CAAzB;AA2BA,QAAM6B,MAAM,GAAGnC,WAAW,CAAC,MAAM;AAC7B6B,IAAAA,MAAM,CAACC,cAAP,CAAsBI,UAAtB,CAAiC,KAAjC;AACAL,IAAAA,MAAM,CAACC,cAAP,CAAsBI,UAAtB,CAAiC,MAAjC;AACAL,IAAAA,MAAM,CAACC,cAAP,CAAsBI,UAAtB,CAAiC,KAAjC;AACD5B,IAAAA,MAAM,CAAC,IAAD,CAAN;AACAE,IAAAA,OAAO,CAAC,IAAD,CAAP;AACF,GANyB,EAMvB,CAACF,MAAD,EAASE,OAAT,CANuB,CAA1B;AAUA,SAAM;AACF4B,IAAAA,QAAQ,EAAEC,OAAO,CAAChC,GAAD,CADf;AAEFQ,IAAAA,SAFE;AAGFE,IAAAA,KAHE;AAIFoB,IAAAA,MAJE;AAKFxB,IAAAA,OALE;AAMFJ,IAAAA,IANE;AAOFE,IAAAA;AAPE,GAAN;AASH;;GAnDuBL,O;;AAmDvB","sourcesContent":["import React, {useCallback, useContext, useState} from 'react';\r\nimport Context from \"../Context/UserContextProvider\";\r\n\r\n export default function useUser () {\r\n    const {jwt, setJWT, user, setUser, rol, setRol} = useContext(Context);\r\n    const [invalid, setInvalid] = useState(false);\r\n    const [isLoading, setIsLoading] = useState(false);\r\n\r\n     const login = useCallback((item) => {\r\n         const cargoUtil = JSON.stringify(item);\r\n         setIsLoading(true);\r\n         fetch(\"http://localhost/IniciaSessio.php\",{\r\n             method:\"POST\",\r\n             headers: {\r\n                 \"Content-Type\": 'application/json'\r\n             },\r\n             body: cargoUtil\r\n         }).then(res=>{\r\n             return res.json()\r\n         }).then((res)=>{\r\n             if(!res) return setInvalid(true);\r\n             console.log(res['rol']);\r\n             window.sessionStorage.setItem('jwt',res['jwt']);\r\n             window.sessionStorage.setItem('user',item['usuari']);\r\n             window.sessionStorage.setItem('rol',res['rol']);\r\n             setIsLoading(false);\r\n             setRol(res['rol']);\r\n             setUser(item['usuari']);\r\n             setJWT(res['jwt']);\r\n         }).catch(err => {\r\n             setIsLoading(false);\r\n             window.sessionStorage.removeItem('jwt');\r\n             })\r\n     }, [setJWT]);\r\n\r\n     const logout = useCallback(() => {\r\n         window.sessionStorage.removeItem('jwt');\r\n         window.sessionStorage.removeItem('user');\r\n         window.sessionStorage.removeItem('rol');\r\n        setJWT(null);\r\n        setUser(null);\r\n     }, [setJWT, setUser])\r\n\r\n\r\n\r\n     return{\r\n         isLogged: Boolean(jwt),\r\n         isLoading,\r\n         login,\r\n         logout,\r\n         invalid,\r\n         user,\r\n         rol\r\n     }\r\n };\r\n\r\n\r\n\r\n"]},"metadata":{},"sourceType":"module"}