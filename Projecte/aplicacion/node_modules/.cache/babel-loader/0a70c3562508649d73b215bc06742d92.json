{"ast":null,"code":"var _s = $RefreshSig$();\n\nimport React, { useCallback, useContext, useState } from 'react';\nimport Context from \"../Context/UserContextProvider\";\nexport default function useUser() {\n  _s();\n\n  const {\n    jwt,\n    setJWT\n  } = useContext(Context);\n  const [user, setUser] = useState('');\n  const [invalid, setInvalid] = useState(false);\n  const login = useCallback(item => {\n    const cargoUtil = JSON.stringify(item);\n    alert(cargoUtil);\n    fetch(\"http://localhost/IniciaSessio.php\", {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": 'application/json'\n      },\n      body: cargoUtil\n    }).then(res => {\n      return res.json();\n    }).then(res => {\n      if (!res) setInvalid(true);\n      window.sessionStorage.setItem('jwt', res);\n      setJWT(res);\n    }).catch(err => {\n      window.sessionStorage.removeItem('jwt');\n      alert(err);\n    });\n  }, [setJWT]);\n  const logout = useCallback(() => {\n    window.sessionStorage.removeItem('jwt');\n    setJWT(null);\n    setUser(null);\n  }, [setJWT]);\n  const foundname = useCallback(() => {\n    const cargoUtil = JSON.stringify(jwt);\n    fetch(\"http://localhost/foundname.php\", {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": 'application/json'\n      },\n      body: cargoUtil\n    }).then(res => {\n      if (!res.ok) throw new Error('Response is NOT ok');\n      return res.json();\n    }).then(res => {\n      setUser(res);\n    }).catch(err => {\n      alert(err);\n    });\n  });\n  return {\n    isLogged: Boolean(jwt),\n    login,\n    logout,\n    foundname,\n    invalid,\n    user\n  };\n}\n\n_s(useUser, \"f1/jhQ1vk6tR5O2N5qaZZsmZPZs=\");\n\n;","map":{"version":3,"sources":["C:/Users/Lucas/OneDrive/Escritorio/TFG/Projecte/aplicacion/src/Servicio/autenticationservice.js"],"names":["React","useCallback","useContext","useState","Context","useUser","jwt","setJWT","user","setUser","invalid","setInvalid","login","item","cargoUtil","JSON","stringify","alert","fetch","method","headers","body","then","res","json","window","sessionStorage","setItem","catch","err","removeItem","logout","foundname","ok","Error","isLogged","Boolean"],"mappings":";;AAAA,OAAOA,KAAP,IAAeC,WAAf,EAA4BC,UAA5B,EAAwCC,QAAxC,QAAuD,OAAvD;AACA,OAAOC,OAAP,MAAoB,gCAApB;AAEC,eAAe,SAASC,OAAT,GAAoB;AAAA;;AAChC,QAAM;AAACC,IAAAA,GAAD;AAAMC,IAAAA;AAAN,MAAgBL,UAAU,CAACE,OAAD,CAAhC;AACA,QAAM,CAACI,IAAD,EAAOC,OAAP,IAAkBN,QAAQ,CAAC,EAAD,CAAhC;AACA,QAAM,CAACO,OAAD,EAAUC,UAAV,IAAwBR,QAAQ,CAAC,KAAD,CAAtC;AAEC,QAAMS,KAAK,GAAGX,WAAW,CAAEY,IAAD,IAAU;AAChC,UAAMC,SAAS,GAAGC,IAAI,CAACC,SAAL,CAAeH,IAAf,CAAlB;AACAI,IAAAA,KAAK,CAACH,SAAD,CAAL;AACAI,IAAAA,KAAK,CAAC,mCAAD,EAAqC;AACtCC,MAAAA,MAAM,EAAC,MAD+B;AAEtCC,MAAAA,OAAO,EAAE;AACL,wBAAgB;AADX,OAF6B;AAKtCC,MAAAA,IAAI,EAAEP;AALgC,KAArC,CAAL,CAMGQ,IANH,CAMQC,GAAG,IAAE;AACT,aAAOA,GAAG,CAACC,IAAJ,EAAP;AACH,KARD,EAQGF,IARH,CAQSC,GAAD,IAAO;AACX,UAAG,CAACA,GAAJ,EAASZ,UAAU,CAAC,IAAD,CAAV;AACTc,MAAAA,MAAM,CAACC,cAAP,CAAsBC,OAAtB,CAA8B,KAA9B,EAAoCJ,GAApC;AACAhB,MAAAA,MAAM,CAACgB,GAAD,CAAN;AACH,KAZD,EAYGK,KAZH,CAYSC,GAAG,IAAI;AACZJ,MAAAA,MAAM,CAACC,cAAP,CAAsBI,UAAtB,CAAiC,KAAjC;AACAb,MAAAA,KAAK,CAACY,GAAD,CAAL;AAAW,KAdf;AAeH,GAlBwB,EAkBtB,CAACtB,MAAD,CAlBsB,CAAzB;AAoBA,QAAMwB,MAAM,GAAG9B,WAAW,CAAC,MAAM;AAC7BwB,IAAAA,MAAM,CAACC,cAAP,CAAsBI,UAAtB,CAAiC,KAAjC;AACDvB,IAAAA,MAAM,CAAC,IAAD,CAAN;AACAE,IAAAA,OAAO,CAAC,IAAD,CAAP;AACF,GAJyB,EAIvB,CAACF,MAAD,CAJuB,CAA1B;AAMA,QAAMyB,SAAS,GAAG/B,WAAW,CAAC,MAAM;AAChC,UAAMa,SAAS,GAAGC,IAAI,CAACC,SAAL,CAAeV,GAAf,CAAlB;AACAY,IAAAA,KAAK,CAAC,gCAAD,EAAkC;AACnCC,MAAAA,MAAM,EAAC,MAD4B;AAEnCC,MAAAA,OAAO,EAAE;AACL,wBAAgB;AADX,OAF0B;AAKnCC,MAAAA,IAAI,EAAEP;AAL6B,KAAlC,CAAL,CAMGQ,IANH,CAMQC,GAAG,IAAE;AACT,UAAG,CAACA,GAAG,CAACU,EAAR,EAAY,MAAM,IAAIC,KAAJ,CAAU,oBAAV,CAAN;AACZ,aAAOX,GAAG,CAACC,IAAJ,EAAP;AACH,KATD,EASGF,IATH,CASSC,GAAD,IAAO;AACXd,MAAAA,OAAO,CAACc,GAAD,CAAP;AACH,KAXD,EAWGK,KAXH,CAWSC,GAAG,IAAI;AACZZ,MAAAA,KAAK,CAACY,GAAD,CAAL;AAAW,KAZf;AAaH,GAf4B,CAA7B;AAiBA,SAAM;AACFM,IAAAA,QAAQ,EAAEC,OAAO,CAAC9B,GAAD,CADf;AAEFM,IAAAA,KAFE;AAGFmB,IAAAA,MAHE;AAIFC,IAAAA,SAJE;AAKFtB,IAAAA,OALE;AAMFF,IAAAA;AANE,GAAN;AAQH;;GAxDuBH,O;;AAwDvB","sourcesContent":["import React, {useCallback, useContext, useState} from 'react';\r\nimport Context from \"../Context/UserContextProvider\";\r\n\r\n export default function useUser () {\r\n    const {jwt, setJWT} = useContext(Context);\r\n    const [user, setUser] = useState('');\r\n    const [invalid, setInvalid] = useState(false);\r\n\r\n     const login = useCallback((item) => {\r\n         const cargoUtil = JSON.stringify(item);\r\n         alert(cargoUtil);\r\n         fetch(\"http://localhost/IniciaSessio.php\",{\r\n             method:\"POST\",\r\n             headers: {\r\n                 \"Content-Type\": 'application/json'\r\n             },\r\n             body: cargoUtil\r\n         }).then(res=>{\r\n             return res.json()\r\n         }).then((res)=>{\r\n             if(!res) setInvalid(true);\r\n             window.sessionStorage.setItem('jwt',res);\r\n             setJWT(res)\r\n         }).catch(err => {\r\n             window.sessionStorage.removeItem('jwt');\r\n             alert(err)})\r\n     }, [setJWT]);\r\n\r\n     const logout = useCallback(() => {\r\n         window.sessionStorage.removeItem('jwt');\r\n        setJWT(null);\r\n        setUser(null);\r\n     }, [setJWT])\r\n\r\n     const foundname = useCallback(() => {\r\n         const cargoUtil = JSON.stringify(jwt);\r\n         fetch(\"http://localhost/foundname.php\",{\r\n             method:\"POST\",\r\n             headers: {\r\n                 \"Content-Type\": 'application/json'\r\n             },\r\n             body: cargoUtil\r\n         }).then(res=>{\r\n             if(!res.ok) throw new Error('Response is NOT ok')\r\n             return res.json()\r\n         }).then((res)=>{\r\n             setUser(res);\r\n         }).catch(err => {\r\n             alert(err)})\r\n     });\r\n\r\n     return{\r\n         isLogged: Boolean(jwt),\r\n         login,\r\n         logout,\r\n         foundname,\r\n         invalid,\r\n         user\r\n     }\r\n };\r\n\r\n\r\n\r\n"]},"metadata":{},"sourceType":"module"}